!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Failure=e()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){function CallSite(frame){return this instanceof CallSite?void(this.frame=frame):new CallSite(frame)}CallSite.prototype=Object.create({getLineNumber:function(){return this.frame.lineNumber},getColumnNumber:function(){return this.frame.columnNumber},getFileName:function(){return this.frame.fileName},getFunction:function(){return this.frame["function"]},getThis:function(){return null},getTypeName:function(){return null},getMethodName:function(){return this.frame.functionName?this.frame.functionName.split(".").pop():null},getFunctionName:function(){return this.frame.functionName},getEvalOrigin:function(){return null},isToplevel:function(){return!1},isEval:function(){return!1},isNative:function(){return!1},isConstructor:function(){return/^new(\s|$)/.test(this.frame.functionName)},toString:function(){var name=this.getFunctionName()||"<anonymous>",loc=this.getFileName()+":"+this.getLineNumber()+":"+this.getColumnNumber();return name+" ("+loc+")"}}),module.exports=CallSite},{}],2:[function(require,module){(function(process,global){function Failure(message,sff){return this instanceof Failure?(this.sff=sff||this.constructor,this.message=message,this._getFrames=makeFramesGetter(this.sff),"function"!=typeof Object.defineProperty&&(this.frames=unwind(this._getFrames()),this._getFrames(!0),this._getFrames=null,this.stack=this.generateStackTrace()),this):new Failure(message,sff||Failure)}function trim(frames,sff){for(var fn,name=sff.name,i=0;i<frames.length;i++)if(fn=frames[i].getFunction(),fn&&fn===sff||name&&name===frames[i].getFunctionName())return frames.slice(i+1);return frames}function unwind(frames){for(var fn,result=[],i=0;i<frames.length;i++)if(fn=frames[i].getFunction(),fn&&fn["failure:ignore"]||result.push(frames[i]),fn&&fn["failure:frames"]){if(Failure.FRAME_EMPTY&&result.push(null),"function"==typeof fn["failure:frames"]){var getter=fn["failure:frames"];fn["failure:frames"]=null,fn["failure:frames"]=getter()}result.push.apply(result,unwind(fn["failure:frames"]));break}return result}function makeFramesGetterV8(sff){NativeError.captureStackTrace(V8FRAMES,sff||makeFramesGetterV8),sff=null;var frames=V8FRAMES.stack;return V8FRAMES.stack=null,function(){var result=frames;return frames=null,result}}function makeFramesGetterCompat(sff){for(var error=getErrorWithStack(),caller=arguments.callee,functions=[getErrorWithStack],i=0;caller&&10>i&&(functions.push(caller),caller.caller!==caller);i++)caller=caller.caller;return caller=null,function(cleanup){var frames=null;if(!cleanup){frames=ErrorStackParser.parse(error);for(var i=2;i<frames.length;i++)frames[i]["function"]=functions[i],frames[i]=new CallSite(frames[i]);frames=trim(frames.slice(2),sff)}return sff=null,error=null,functions=null,frames}}function exclude(ctor,predicate){var fn=predicate;"string"==typeof predicate?fn=function(frame){return-1!==frame.getFileName().indexOf(predicate)}:"function"==typeof predicate.test&&(fn=function(frame){return predicate.test(frame.getFileName())}),ctor.excludes.push(fn)}var ErrorStackParser=require("error-stack-parser"),CallSite=require("./call-site"),NativeError=Error;Failure.FRAME_EMPTY="  ----------------------------------------",Failure.FRAME_PREFIX="  at ",Failure.TRACK=!0;var getErrorWithStack=function(){return new NativeError};getErrorWithStack().stack||(getErrorWithStack=function(){try{throw new NativeError}catch(e){return e}});var V8FRAMES={},makeFramesGetter="function"==typeof NativeError.captureStackTrace?makeFramesGetterV8:makeFramesGetterCompat,oldPrepareStackTrace=Error.prepareStackTrace;Error.prepareStackTrace=function(error,frames){return error===V8FRAMES?frames:oldPrepareStackTrace?oldPrepareStackTrace.call(Error,error,frames):Failure.prototype.prepareStackTrace.call(error,unwind(frames))},Failure.excludes=[],Failure.exclude=function(predicate){exclude(Failure,predicate)},Failure.track=function Failure_track(fn,sff){return"function"!=typeof fn?fn:("function"==typeof fn["failure:frames"]&&fn["failure:frames"](!0),Failure.TRACK&&(fn["failure:frames"]=null,fn["failure:frames"]=makeFramesGetter(sff||Failure_track)),fn)},Failure.wrap=function Failure_wrap(fn){var wrapper=Failure.ignore(function(){return fn.apply(this,arguments)});return Failure.track(wrapper,Failure_wrap)},Failure.ignore=function(fn){return fn["failure:ignore"]=!0,fn},Failure.setTimeout=function Failure_setTimeout(){return arguments[0]=Failure.track(arguments[0],Failure_setTimeout),setTimeout.apply(null,arguments)},Failure.nextTick=function Failure_nextTick(){return arguments[0]=Failure.track(arguments[0],Failure_nextTick),process.nextTick.apply(process,arguments)},Failure.patch=function(obj,name,idx){if(obj&&"function"!=typeof obj[name])throw new Error('Object does not have a "'+name+'" method');var original=obj[name];obj[name]="number"==typeof idx?function(){return arguments[idx]=Failure.track(arguments[idx],obj[name]),original.apply(this,arguments)}:function(){for(var i=0;i<arguments.length;i++)"function"==typeof arguments[i]&&(arguments[i]=Failure.track(arguments[i],obj[name]));return original.apply(this,arguments)};for(var k in original)original.hasOwnProperty(k)&&(obj[name][k]=original[k]);return obj[name]},Failure.create=function(name,props){function ctor(message,sff){return this instanceof Failure?void Failure.apply(this,arguments):new ctor(message,sff)}if("string"!=typeof name)throw new Failure("Expected a name as first argument");return ctor.excludes=[],ctor.exclude=function(predicate){exclude(ctor,predicate)},ctor.prototype=Object.create(Failure.prototype),ctor.prototype.constructor=ctor,ctor.prototype.name=name,"function"==typeof props?ctor.prototype.prepareStackTrace=props:props&&Object.keys(props).forEach(function(prop){ctor.prototype[prop]=prop}),ctor};var builtinErrorTypes=["Error","TypeError","RangeError","ReferenceError","SyntaxError","EvalError","URIError","InternalError"],builtinErrors={};Failure.install=function(){var root="object"==typeof window?window:global;return builtinErrorTypes.forEach(function(type){root[type]&&!builtinErrors[type]&&(builtinErrors[type]=root[type],root[type]=Failure.create(type))}),Failure},Failure.uninstall=function(){builtinErrorTypes.forEach(function(type){root[type]=builtinErrors[type]||root[type]})};var proto=Failure.prototype=Object.create(Error.prototype);proto.constructor=Failure,proto.name="Failure",proto.message="","function"==typeof Object.defineProperty&&(Object.defineProperty(proto,"frames",{get:function(){var frames=unwind(trim(this._getFrames(),this.sff));return Object.defineProperty(this,"frames",{value:frames,writable:!0}),this._getFrames=null,frames}}),Object.defineProperty(proto,"stack",{get:function(){return this.generateStackTrace()}})),proto.generateStackTrace=function(){var include,excludes=this.constructor.excludes,frames=[];excludes!==Failure.excludes&&excludes.push.apply(excludes,Failure.excludes);for(var i=0;i<this.frames.length;i++){if(include=!0,this.frames[i])for(var j=0;include&&j<excludes.length;j++)include&=!excludes[j].call(this,this.frames[i]);include&&frames.push(this.frames[i])}return this.prepareStackTrace(frames)},proto.prepareStackTrace=function(frames){for(var lines=[this],i=0;i<frames.length;i++)lines.push(frames[i]?Failure.FRAME_PREFIX+frames[i]:Failure.FRAME_EMPTY);return lines.join("\n")},module.exports=Failure}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./call-site":1,_process:4,"error-stack-parser":5}],3:[function(require,module){var Failure=require("./lib/failure");module.exports=Failure},{"./lib/failure":2}],4:[function(require,module){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canMutationObserver="undefined"!=typeof window&&window.MutationObserver,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};var queue=[];if(canMutationObserver){var hiddenDiv=document.createElement("div"),observer=new MutationObserver(function(){var queueList=queue.slice();queue.length=0,queueList.forEach(function(fn){fn()})});return observer.observe(hiddenDiv,{attributes:!0}),function(fn){queue.length||hiddenDiv.setAttribute("yes","no"),queue.push(fn)}}return canPost?(window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}):function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")}},{}],5:[function(require,module,exports){!function(root,factory){"use strict";"function"==typeof define&&define.amd?define("error-stack-parser",["stackframe"],factory):"object"==typeof exports?module.exports=factory(require("stackframe")):root.ErrorStackParser=factory(root.StackFrame)}(this,function(StackFrame){"use strict";Array.prototype.map||(Array.prototype.map=function(callback,thisArg){var T,O=Object(this),len=O.length>>>0;arguments.length>1&&(T=thisArg);for(var A=new Array(len),k=0;len>k;){var kValue,mappedValue;k in O&&(kValue=O[k],mappedValue=callback.call(T,kValue,k,O),A[k]=mappedValue),k++}return A}),Array.prototype.filter||(Array.prototype.filter=function(callback){for(var t=Object(this),len=t.length>>>0,res=[],thisArg=arguments.length>=2?arguments[1]:void 0,i=0;len>i;i++)if(i in t){var val=t[i];callback.call(thisArg,val,i,t)&&res.push(val)}return res});var FIREFOX_SAFARI_STACK_REGEXP=/\S+\:\d+/,CHROME_IE_STACK_REGEXP=/\s+at /;return{parse:function(error){if("undefined"!=typeof error.stacktrace||"undefined"!=typeof error["opera#sourceloc"])return this.parseOpera(error);if(error.stack&&error.stack.match(CHROME_IE_STACK_REGEXP))return this.parseV8OrIE(error);if(error.stack&&error.stack.match(FIREFOX_SAFARI_STACK_REGEXP))return this.parseFFOrSafari(error);throw new Error("Cannot parse given Error object")},extractLocation:function(urlLike){var locationParts=urlLike.split(":"),lastNumber=locationParts.pop(),possibleNumber=locationParts[locationParts.length-1];if(!isNaN(parseFloat(possibleNumber))&&isFinite(possibleNumber)){var lineNumber=locationParts.pop();return[locationParts.join(":"),lineNumber,lastNumber]}return[locationParts.join(":"),lastNumber,void 0]},parseV8OrIE:function(error){return error.stack.split("\n").slice(1).map(function(line){var tokens=line.replace(/^\s+/,"").split(/\s+/).slice(1),locationParts=this.extractLocation(tokens.pop().replace(/[\(\)\s]/g,"")),functionName=tokens[0]&&"Anonymous"!==tokens[0]?tokens[0]:void 0;return new StackFrame(functionName,void 0,locationParts[0],locationParts[1],locationParts[2])},this)},parseFFOrSafari:function(error){return error.stack.split("\n").filter(function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)},this).map(function(line){var tokens=line.split("@"),locationParts=this.extractLocation(tokens.pop()),functionName=tokens.shift()||void 0;return new StackFrame(functionName,void 0,locationParts[0],locationParts[1],locationParts[2])},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var lineRE=/Line (\d+).*script (?:in )?(\S+)/i,lines=e.message.split("\n"),result=[],i=2,len=lines.length;len>i;i+=2){var match=lineRE.exec(lines[i]);match&&result.push(new StackFrame(void 0,void 0,match[2],match[1]))}return result},parseOpera10:function(e){for(var lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,lines=e.stacktrace.split("\n"),result=[],i=0,len=lines.length;len>i;i+=2){var match=lineRE.exec(lines[i]);match&&result.push(new StackFrame(match[3]||void 0,void 0,match[2],match[1]))}return result},parseOpera11:function(error){return error.stack.split("\n").filter(function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)&&!line.match(/^Error created at/)},this).map(function(line){var argsRaw,tokens=line.split("@"),locationParts=this.extractLocation(tokens.pop()),functionCall=tokens.shift()||"",functionName=functionCall.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;functionCall.match(/\(([^\)]*)\)/)&&(argsRaw=functionCall.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var args=void 0===argsRaw||"[arguments not available]"===argsRaw?void 0:argsRaw.split(",");return new StackFrame(functionName,args,locationParts[0],locationParts[1],locationParts[2])},this)}}})},{stackframe:6}],6:[function(require,module,exports){!function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?module.exports=factory():root.StackFrame=factory()}(this,function(){"use strict";function _isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function StackFrame(functionName,args,fileName,lineNumber,columnNumber){void 0!==functionName&&this.setFunctionName(functionName),void 0!==args&&this.setArgs(args),void 0!==fileName&&this.setFileName(fileName),void 0!==lineNumber&&this.setLineNumber(lineNumber),void 0!==columnNumber&&this.setColumnNumber(columnNumber)}return StackFrame.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(v){this.functionName=String(v)},getArgs:function(){return this.args},setArgs:function(v){if("[object Array]"!==Object.prototype.toString.call(v))throw new TypeError("Args must be an Array");this.args=v},getFileName:function(){return this.fileName},setFileName:function(v){this.fileName=String(v)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(v){if(!_isNumber(v))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(v)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(v){if(!_isNumber(v))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(v)},toString:function(){var functionName=this.getFunctionName()||"{anonymous}",args="("+(this.getArgs()||[]).join(",")+")",fileName=this.getFileName()?"@"+this.getFileName():"",lineNumber=_isNumber(this.getLineNumber())?":"+this.getLineNumber():"",columnNumber=_isNumber(this.getColumnNumber())?":"+this.getColumnNumber():"";return functionName+args+fileName+lineNumber+columnNumber}},StackFrame})},{}]},{},[3])(3)});